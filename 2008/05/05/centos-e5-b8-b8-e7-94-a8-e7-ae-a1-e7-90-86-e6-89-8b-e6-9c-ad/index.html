<!DOCTYPE html>
<html>
  <head>
      <script>
  var _hmt = _hmt || []
  ;(function() {
    var hm = document.createElement('script')
    hm.src = 'https://hm.baidu.com/hm.js?5a0acc897fd96474a2c8f4deac84611a'
    var s = document.getElementsByTagName('script')[0]
    s.parentNode.insertBefore(hm, s)
  })()
</script> 
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="keywords" content="technolgy" />
    <meta name="description" content="" />
    
    <title>
      centOS 常用管理手札 - Seven‘s Lab
    </title>
    <link rel="manifest" href="/manifest.json" />
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="../../../../style/style.css">
  <link rel="alternate" href="atom.xml" title="Seven‘s Lab" type="application/atom+xml">
</head>
  <body>
    
    <div id="fixed-menu-wrap">
      <span class="iconfont icon-sousuo search-box menu-reset"></span>
      <span class="icon-toc menu-reset">Toc</span>
      <span class="iconfont icon-arrowup menu-reset"></span>
    </div>
    <div id="fixed-menu">
      <span class="iconfont icon-menu-"></span>
    </div>
    <div id="progress">
      <div class="line"></div>
    </div>
    <div id="search-shade" class="animated hiddenSearch hide">
      <div class="input-wrap">
        <span class="iconfont icon-sousuo search-box"></span>
        <input type="text" placeholder="Search" />
        <span class="iconfont icon-close"></span>
      </div>
      <div class="search-result">
        <div class="meta">
          <span><b id="result-count">0</b> results found</span>
          <img src="/images/logo.jpeg" />
        </div>
        <ul id="result-box"></ul>
      </div>
    </div>
    <div id="menu-mask" class="animated hideMenuMask hide">
      <span class="iconfont icon-close"></span>
      <div class="nav">
        
        <a href="../../../../index.html" class="">
          Home
        </a>
        
        <a href="../../../../archives" class="">
          Archives
        </a>
        
        <a href="../../../../categories" class="">
          Categories
        </a>
        
        <a href="../../../../tags" class="">
          Tags
        </a>
        
        <a href="../../../../about" class="">
          About
        </a>
        
      </div>
    </div>
    <div id="header">
      <div class="intro">
        <a href="/" class="logo" style="background-image: url('/images/logo.jpeg')"></a>
        <div class="author">Seven Chen</div>
      </div>
      <div class="nav">
        <span class="iconfont icon-menu menu-icon"></span>
        <a href="#" class="search-box">
          <span class="iconfont icon-sousuo"></span>
        </a>
      </div>
    </div>
    <div id="side" class="animated bounceInLeft">
      <div class="shrink">
        <a href="/" class="logo" style="background-image: url('/images/logo.jpeg')"></a>
        <span class="iconfont icon-menu toggle-icon"></span>
        <a href="#" class="search-box">
          <span class="iconfont icon-sousuo"></span>
        </a>
      </div>
      <div class="magnify">
        <div class="about">
          <div class="author">Seven Chen</div>
          <a href="/" class="logo" style="background-image: url('/images/logo.jpeg')"></a>
        </div>

        <div class="nav">
          
          <a href="../../../../index.html" class="">
            Home
          </a>
          
          <a href="../../../../archives" class="">
            Archives
          </a>
          
          <a href="../../../../categories" class="">
            Categories
          </a>
          
          <a href="../../../../tags" class="">
            Tags
          </a>
          
          <a href="../../../../about" class="">
            About
          </a>
          
          <a href="#" class="search-box">
            <span class="iconfont icon-sousuo"></span>
          </a>
        </div>
        <div class="bottom">
          <div class="follow">
            
            <a href="https://github.com/askdaddy" target="_block">
              <span class="iconfont icon-github"></span>
            </a>
            
            <a href="https://www.facebook.com/humen1" target="_block">
              <span class="iconfont icon-facebook"></span>
            </a>
            
            <a href="https://twitter.com/humen1" target="_block">
              <span class="iconfont icon-twitter"></span>
            </a>
             
            <a href="/atom.xml" target="_block">
              <span class="iconfont icon-rss"></span>
            </a>
            
          </div>
        </div>
      </div>
    </div>
    <div id="container">
      <div class="main animated bounceInRight delay-0.7s">
        <article class="post-entry">
    <div class="header">
      
      <div class="title">centOS 常用管理手札</div>
      <div class="meta">
        <span class="item">
          <span class="iconfont icon-time-circle"></span>
          <span>2008/05/05</span>
        </span>

        

         
        <span class="item">
          <span class="iconfont icon-folder"></span>
          <span>
              
                
                  <a href="/categories/NULL">NULL</a>
                
              
          </span>
        </span>
        
        
         
          <span class="item">
            <span class="iconfont icon-tag1"></span>
            <span>
                
                  
                    <a href="/tags/unix">unix</a>
                  
                
            </span>
          </span>
         
      </div>
      <div>
      </div>
    </div>
    <p>for centOS</p>
<p>一、用户环境<br>#locale    显示系统语言环境      语言环境参数保存在/etc/sysconfig/i18n文件里 LANG最主要<br>#locale �a       查看系统对语言的支持情况<br>#LANG=zh_CN.GB2312       使系统支持以中文形式显示</p>
<p>#chkconfig kudzu –list  检查某个服务状态(包括各个级别0~6的状态)<br>#less /etc/sysconfig/hwconf 硬件信息</p>
<p>二、系统管理常用命令</p>
<ol>
<li><p>useradd redhat</p>
</li>
<li><p>passwd redhat</p>
</li>
<li><p>su �</p>
</li>
<li><p>exit</p>
</li>
<li><p>df �h 分区情况</p>
</li>
<li><p>du �sh  /*      统计文件或目录使用空间的大小</p>
</li>
<li><p>fdisk �l  /dev/sda</p>
</li>
<li><p>netconfig        配置网络参数</p>
</li>
<li><p>ifconfig          显示网络配置信息</p>
</li>
<li><p>service network restart</p>
</li>
<li><p>route �n          查看路由信息（默认路由）</p>
</li>
<li><p>ping �b <a href="http://192.168.0.255" target="_blank" rel="noopener">192.168.0.255</a>    扫描整个网段（检查活动主机）</p>
</li>
<li><p>ifconfig eth0 <a href="http://10.0.0.254" target="_blank" rel="noopener">10.0.0.254</a> netmask <a href="http://255.255.255.0" target="_blank" rel="noopener">255.255.255.0</a>  修改IP地址</p>
</li>
<li><p>ifconfig eth0显示指定网卡参数</p>
</li>
<li><p>修改IP信息后会删除默认路由，需手工添加</p>
</li>
</ol>
<p>route add default gw <a href="http://192.168.0.1" target="_blank" rel="noopener">192.168.0.1</a></p>
<ol start="16">
<li>ifconfig route 修改过的参数不会保存，重启后会消失</li>
</ol>
<p>要用service network restart命令把参数保存到文件ifcfg-eth0</p>
<p>/etc/sysconfig/network-scripts/ifcfg-eth0</p>
<p>可以vi直接修改该文件，然后service network restart 重新启用网络服务</p>
<ol start="17">
<li>redhat-config-network-tui是redhat独有的配置工具，当用这个命令配置网络参数后，会写入到/etc/sysconfig/networking/profiles/目录里，并且比network-scripts/ifcfg-eth0优先，所以用过这个工具配置就不要再使用netconfig，或者先将profiles目录清空</li>
</ol>
<p>三、文件系统维护</p>
<p>ext2/ext3通过数据块储存文件</p>
<p>格式化文件系统：</p>
<p>mkfs.ext3 �b 4096 �i 8192 �m 5 /dev/sdb4</p>
<p>-b      数据块大小</p>
<p>-i inode节点表示的字节数（或数据块大小）</p>
<p>-m 5      为管理员保留的磁盘管理空间5% </p>
<p>ls �lh /mnt/u</p>
<p>du �sh /mnt/u</p>
<p>df �lh</p>
<p>#tune2fs �l /dev/sdb1          打印文件系统属性</p>
<p>#df</p>
<p>tune2fs 调整ext2/ext3文件系统特性的工具</p>
<p>-l 查看文件系统信息</p>
<p>-m      保留块百分比</p>
<p>-c   设置强制自检的挂载次数</p>
<p>-i   设置强制自检的间隔时间</p>
<p>-j          ext2转成ext3</p>
<p>tune2fs �c -1 /dev/sdb1    不管挂载多小次都不自检</p>
<p>tune2fs �c -1 �i 0 /dev/sdb1  让分区永远不自检</p>
<p>#mkfs.ext2 /dev/sdb4  格式化成ext2</p>
<p>#tune2fs �j /dev/sdb4  转换为ext3</p>
<p>#df �T              查看分区信息</p>
<p>判断间ext2还是ext3:</p>
<p>tune2fs �l /dev/sdb1 | grep features</p>
<p>看Filesystem features： has_journal</p>
<p>是否有has_journal，有则是ext3文件系统</p>
<p>grep �i “name”  不区分大小写</p>
<p>df �T 分区类型</p>
<p>fsck      检查文件系统数据完整性的工具</p>
<p>用法一、fsck �t ext2 /dev/sdb1</p>
<p>  二、fsck.ext3 /dev/sdb1</p>
<p>#more /etc/fstab</p>
<p>如发现挂载选项有1或2，那么应该进行自检了</p>
<p>#fsck.ext3 �y /dev/sdb1          自动修复错误</p>
<p>四、管理磁盘文件系统</p>
<p>mount 设备名 挂载点<br>mount /dev/fd0 /mnt/floppy<br>光驱（IDE） /dev/cdrom    (/dev/hdx)<br>光驱（SCSI）/dev/scdN    (N=0,1…)<br>硬盘（IDE） /dev/hdX      (X=a,b,c…)<br>硬盘（SCSI）/dev/sdX      (X=a,b,c…)<br>U盘        /dev/sdX      (X=a,b,c…)</p>
<p>弹出光盘#eject<br>收回#eject �t<br>因为USB设备内置USB-SCSI转换接口，所以被认为是SCSI硬盘<br>#mkdir /mnt/u<br>#mount /dev/sda1 /mnt/u<br>默认内核已支持SCSI和USB接口<br>#modprobe usb-storage          检查usb-storage模块是否已加载，否则无法自动识别USB设备</p>
<p>#mount �t vfat /dev/hda2 /mnt/c<br>#mount �t ntfs /dev/hda3 /mnt/d 需重新编译内核才能支持NTFS<br>#mount �t iso9660 /dev/cdrom /mnt/cdrom<br>#mount �t vfat �o iocharset=gb2312 /dev/sdb1 /mnt/u<br>常用字符编码有gb2312和utf8<br>#mount /dev/sdb2 /mmt/d �o iocharset=utf8,ro,uid=redhat,umask=0077 </p>
<p>Linux下使用U盘<br>#ls /dev          确认设备已识别<br>#mount -o iocharset=gb2312 /dev/sda1<br>more后ctrl+F向下翻页（或空格）ctrl+b（上滚）<br>ls -a            显示隐藏文件（以.开头的文件）<br>文件权限rws        s表示执行这个程序的使用者，临时拥有和所有者一样的权力身份来执行该程序<br>cp -r 源  目的    -r参数表示连子目录一起拷贝<br>rm -i            确认删除<br>  -r            删除子目录<br>  -f            强制删除<br>du                磁盘或目 录使用了多少空间<br>df                磁盘或目录剩余可用空间<br>cat &gt;file1        等价你输入文字，输完后ctrl+C或ctrl+D结束  </p>
<blockquote>
<blockquote>
<p>符号表示在文件尾附加，&gt;符号表示创建新文件<br>less  可上下滚动文件内容<br>which    在$PATH设置的目录查找文件</p>
</blockquote>
</blockquote>
<p>五、使用磁盘配额</p>
<p>默认系统内核已支持quota</p>
<p>mount �o usrquota,grpquota /dev/sdb1 /mnt/d1 或</p>
<p>mount �o remount,usrquota,grpquota /</p>
<p>也可以修改 /etc/fstab文件来启用每个文件系统的配额 —- 添加选项usrquota,grpquota</p>
<p>例：</p>
<p>将LABEL=/home  /home  ext3  defaults  1 2<br>改为<br>LABEL=/home  /home  ext3  defaults，usrquota  1 2</p>
<p>#init 1      （进入单用户环境）</p>
<p>#quotacheck �cvuga  或 quotacheck �cvag  /dev/sdb1    （a代表all)(g代表用户组）</p>
<p>#quotaon �a 激活</p>
<p>#edquota �u redhat          进VI编缉用户配额</p>
<p>编缉用户可用的字节数，软性的，硬性的，文件数，软件性的，硬性的</p>
<p>quota �u redhat      查看用户磁盘配额</p>
<p>edquota �t          配置过期时间</p>
<p>edquota命令能为一系列用户设置同一配额。假设已为用户ez设立了配额，以下命令将为随后的用户（即mj、jm和tp）复制完全相同的配额限制：</p>
<p>$ sudo /usr/sbin/edquota -up ez mj jm tp</p>
<p>quotaoff /mnt/sdb1  关闭磁盘配额</p>
<p>quotaon /mnt/sdb1    开启</p>
<p>repquota命令按用户（-u）或组（-g）报告配额使用情况。用repquota -a命令可以得到所有文件系统的报告。</p>
<p>如果想检查单个用户（-u）或组（-g），可以使用quota命令。单个用户可以用此命令检查他们自己的配额使用情况。</p>
<p>关于putty 0.58的简单设置</p>
<ol>
<li><p>修改语言环境 LANG=zh_CN.utf8</p>
</li>
<li><p>修改传输数据的字符集translationàUTF8</p>
</li>
<li><p>修改外观appearance字体font为新宋体</p>
<p>ls �ld      显示文件属主，详细信息</p>
</li>
</ol>
<p>六、Raid</p>
<p>安全的动态磁盘策略<br>linux内核可以模拟RAID控制器，用来管理硬盘，但只支持级别0,1,4,5<br>RAID0 又称striping<br>把连续的数据访问分散到多个磁盘上来提高存储性能，速度最快，但最危险。<br>RAID1 又称Mirror或Mirroring<br>最大限度的保证用户数据的可用性和可修复性，用户数据100%自动复制到另外一个硬盘上，速度稍慢，因为要同时写多个硬盘。<br>RAID5    最少需三个硬盘<br>不对存储的数据时行备份，而把数据和对应的奇偶校验信息分别存储在不同的磁盘上，当一个磁盘数据发生损坏后，利用剩下的数据和相应的奇偶校验信息去恢复被损坏的数据。<br>RAID0+1      也称RAID10<br>结合RAID0和RAID1的优点，很多公司在应用</p>
<p>Linux中的软件RAID<br>1.默认内核已支持软件RAID控制器<br>2.需安装raidtools工具来创建管理RAID设备，raidtools包含有RAID创建管理工具和默认的示范性配置文件，安装完后编辑/etc/raidtab这配置文件，它可以从raidtools中的示范配置文件里（在/usr/share/doc/raid-~/目录下）复制。最后用以下命令创建RAID设备：</p>
<p>#mkraid /dev/md0<br>#mkraid -f /dev/md0<br>#mkraid -R /dev/md0<br>  后两个命令是强制创建，覆盖以前建的超级块。</p>
<p>  但Fedora Core5不使用这个，而用mdadm工具。<br>3.软件RAID设备文件名：/dev/mdN        (N=0,1,2…)<br>4.软件RAID设备可以当分区看待，需格式化后挂载<br>#mkfs.ext3    /dev/md1<br>#mount /dev/md1 /opt<br>5.停止RAID设备<br>#umount /opt<br>#raidstop /dev/md0<br>  要永久删除RAID设备，还需删除raidtab文件，否则重启后RAID仍起作用。<br>6.显示RAID设备信息<br>#lsraid -A -a /dev/md1<br>7.RAID1故障模拟<br>  假设sdb1与sdc1两个磁盘做RAID1，sdb1磁盘坏了，加入新一块磁盘sdd1。<br>#raidsetfaulty /dev/md1 /dev/sdb1<br>#raidhotadd /dev/md1 /dev/sdd1<br>#more /proc/mdstat                    查看磁盘修复过程<br>#raidhotremove /dev/sdb1<br>  最后还要修改raidtab文件。</p>
<p>使用mdadm来创建和管理RAID<br>RAID0<br>      添加硬盘<br>      RAID设备的成员是硬盘分区，需先对硬盘分区，分区不能在同一物理硬盘上<br>      #fdisk /dev/sdb<br>      n创建主分区，t分区类型fd，w写保存<br>      #fdisk /dev/sdc<br>      #mdadm �Cv /dev/md0 �l0 �n2 /dev/sdb1 /dev/sdc1<br>              -C,–create            创建一个新的阵列<br>              -v,verbose            显示细节<br>              /dev/md0              阵列设备的名称<br>              -l,–level=              阵列级别，如0,1,4,5,6<br>              -n,–raid-devices=  阵列活动数目<br>              /dev/sd[bc]1          阵列包含的设备列表<br>      #more /proc/mdstat              查看阵列状态<br>      #mkfs.ext3 /dev/md0    创建文件系统<br>      #mount /dev/md0 /mnt/raid<br>      让系统自动挂载，修改/etc/fstab,添加<br>      /dev/md0      /mnt/raid        ext3 defaults 0 0</p>
<p>RAID5 故障模拟<br>      前面已创建了一个RAID5设备md0<br>      #mdadm �Cv /dev/md0 �l5 �n3 �x1 �c128 /dev/sd[b,c,d,e]1<br>      1.将/dev/sdb1标记为已损坏的设备<br>      #mdadm /dev/md0 �f  /dev/sdb1<br> &amp;n bsp;    这时阵列开始重构和恢复数据<br>      2.移除损坏的设备<br>      #mdadm /dev/md0 �r /dev/sdb1<br>      3.将新设备添加到阵列<br>      注意，一：对硬盘正确分区，二：添加设备名要与被移除的一致，如sdb1<br>      #mdadm /dev/md0 �a /dev/sdb1  </p>
<p>生成配置文件/etc/mdadm.conf<br>格式如下：<br>DEVICE /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1 ARRAY /dev/md10 level=raid10 num-devices=4 UUID=12334343dkfj</p>
<p>其中UUID信息通过#mdadm �D /dev/md10得到<br>#mdadm �Ds 扫描该文件信息</p>
<p>常用阵列维护命令<br>1.启用阵列<br>      #mdadm �As /dev/md0<br>      -A    启用已存在的阵列<br>      -s    以/etc/mdadm.conf为依据<br>      没有创建mdadm.conf文件，则采用如下方法启用<br>      #mdadm �A /dev/md0 /dev/sd[bc]1<br>2.停止阵列<br>      #mdadm �S /dev/md0<br>3.显示阵列详细信息<br>      #mdadm �D /dev/md0</p>
<p>humen1 Tech</p>


  
  <div class="post-guide">
    <div class="item left">
        
          <a href="2008/05/05/e9-98-b2-e6-ad-a2ssh-e6-81-b6-e6-84-8f-e6-94-bb-e5-87-bb/">防止Ssh恶意攻击</a>
        
    </div>
    <div class="item right">
        
          <a href="2008/04/18/e6-ad-a3-e5-88-99-e5-8c-b9-e9-85-8demail-e4-b8-8d-e5-85-a8-e9-9d-a2php/">正则匹配Email - 不全面[Php]</a>
        
    </div>
  </div>

  

  <div class="post-copyright">
    <div class="auth">
      本文作者：<a href="http://www.humen1.com">Seven Chen</a>
    </div>
    <div class="link">
      永久链接：<a href="http://www.humen1.com">http://www.humen1.com</a>
    </div>
    <div class="declare">
      版权声明：本文首发于<a href="http://www.humen1.com">Seven Chen</a>的博客，转载请注明出处！
    </div>
  </div>

  <div id="comment"></div>

  
  
</article>
        <footer>
          <div class="copyright">
            ©2019
            <a href="http://www.humen1.com">Seven Chen</a> Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> |
            <a href="https://github.com/shixiaohu2206/hexo-theme-huhu" target="_blank" rel="noopener">hexo-theme-huhu</a>
          </div>
          
        </footer>
      </div>
    </div>
  </body>
  
</html>
<script type="text/javascript">
                  window.HUHU_CONFIG = JSON.parse("{\"share\":[\"weibo\",\"weixin\",\"qqkongjian\",\"QQ\",\"douban\",\"facebook\",\"twitter\",\"google\"],\"service_worker\":{\"open\":false}}")
                </script> <script type="text/javascript">window.addEventListener('load', function() {
    
    window.loadJs = function(d, m, a) {
      var c = document.getElementsByTagName('head')[0] || document.head || document.documentElement
      var b = document.createElement('script')
      b.defer = true
      b.setAttribute('type', 'text/javascript')
      b.setAttribute('charset', 'UTF-8')
      b.setAttribute('async', 'true')
      b.setAttribute('src', d)
      m && b.setAttribute('data-main', '/scripts/app-built')
      if (typeof a === 'function') {
        if (window.attachEvent) {
          b.onreadystatechange = function() {
            var e = b.readyState
            if (e === 'loaded' || e === 'complete') {
              b.onreadystatechange = null
              a()
            }
          }
        } else {
          b.onload = a
        }
      }
      c.appendChild(b)
    }
    window.loadJs && window.loadJs('https://cdn.bootcss.com/require.js/2.3.6/require.min.js', true, function() {require.config({"paths":{"util":"util","share":"share","search":"search","registerSW":"registerSW","valine":"cdn/Valine.min","av":["https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min"],"pjax":["https://cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min"],"jquery":["https://cdn.bootcss.com/jquery/3.4.1/jquery.min"],"confirm":["https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min"],"fancybox":["https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min"],"chart":["https://cdn.bootcss.com/Chart.js/2.8.0-rc.1/Chart.bundle.min"]},"map":{"*":{"css":"https://cdn.bootcss.com/require-css/0.1.10/css.min.js"}},"shim":{"fancybox":{"deps":["css!https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css"]},"confirm":{"deps":["css!https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min.css"]},"chart":{"deps":["css!https://cdn.bootcss.com/Chart.js/2.8.0-rc.1/Chart.min.css"]}},"waitSeconds":3})})
  })</script> <script type="text/javascript">
                  ;(function() {
                    var bp = document.createElement('script')
                    var curProtocol = window.location.protocol.split(':')[0]
                    if (curProtocol === 'https') {
                      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js'
                    } else {
                      bp.src = 'http://push.zhanzhang.baidu.com/push.js'
                    }
                    var s = document.getElementsByTagName('script')[0]
                    s.parentNode.insertBefore(bp, s)
                  })()
                </script> 
